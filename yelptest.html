<!DOCTYPE html>
<html lang="en">
    
    <head>
        <meta charset="utf-8">
        <title>Tag Team</title>

        <!-- stylesheets -->
        <link type="text/css" rel="stylesheet" href="styles/bootstrap/bootstrap.min.css" />
        <link type="text/css" rel="stylesheet" href="styles/bootstrap/bootstrap-responsive.min.css" />

        <!-- scripts -->
        <script type="text/javascript" src="scripts/jquery-1.8.3.min.js"></script>
        <script type="text/javascript" src="scripts/mustache.js"></script>
        <script type="text/javascript" src="scripts/jquery-Mustache.js"></script>
        <script type="text/javascript" src="scripts/moment.js"></script>
        <script type="text/javascript" src="scripts/bootstrap.min.js"></script>
        <script type="text/javascript" src="scripts/auth/oauth.js"></script>
        <script type="text/javascript" src="scripts/auth/sha1.js"></script>
        <script type="text/javascript" src="scripts/auth/yelpauth.js"></script>
        <script type="text/javascript">
            (function () {
   
                $(function() {
                    
                    $.Mustache.addFromDom();

                    var message = { 
                        action: 'http://api.yelp.com/v2/business/bay-to-breakers-12k-san-francisco',
                        method: 'GET'
                    };

                    var parameterMap = getParamMapForAuth(message);

                    doYelpCall(message.method, message.action, parameterMap);

                });

                function doYelpCall(type, url, data) {
                    $.ajax({
                        type: type,
                        url: url,
                        data: data,
                        cache: true,
                        dataType: 'jsonp',
                        jsonpCallback: 'cb',
                        success: function(data, statusText, XMLHttpRequest) {
                            $('#bizResults').mustache('business', data, {method:'html'});
                        },
                        error: function() {
                            alert('yelp api call failed!');
                        }
                    });
                }

            })();
        </script>
    </head>

    <body>
        <div class="container">
            <div class="page-header">
                <h1>Tag Team
                    <br />
                    <small>4 guys, 1 site.</small>
                </h1>
            </div>
            <div class="row">
                <div class="span6">
                    <div class="row" id="bizResults"></div>
                </div>
                <div class="span6">
                    <h3>Right half</h3>
                </div>
            </div>
            </div>
        </div>
    </body>

</html>

<!-- mustache templates -->

<script id="alert" type="text/html">
    <div class="alert alert-{{type}} fade in">
        <button type="button" class="close" data-dismiss="alert">Ã—</button>
        <strong>Oops!</strong> {{message}}
    </div>
</script>

<script id="business" type="text/html">
    <div class="business">
        <h3>{{name}}</h3>
        <h4>{{location.cross_streets}}, {{location.city}}</h4>
        <p>
            <img src="{{image_url}}" alt="" />
        </p>
        <p>
            # reviews: {{review_count}}
        </p>
        <p>
            Rating: {{rating}}
            <img src="{{rating_img_url}}" alt="" />
        </p>
        <p>
            Example Review Snippet:
            <img src="{{snippet_img_url}}" alt="" />
            {{snippet_text}}
        </p>
        <p>
            View this business on 
            <a href="{{url}}">
                <img src="http://s3-media1.ak.yelpcdn.com/assets/2/www/img/14f29ad24935/map/miniMapLogo.png" alt="" />
            </a>
        </p>
    </div>
</script>