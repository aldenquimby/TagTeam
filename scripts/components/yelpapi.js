
function YelpApi(onApiError) {

    // private members

    var auth = {
        consumerKey: "vUUxfoVd8JucIOiSrx7QMQ",
        consumerSecret: "2Asg9ACoJ2GbpSKBx00ZGVaumHQ",
        accessToken: "fuLqILJMeG8GQBjy6I83Ouz1wwlXqAWs",
        accessTokenSecret: "6_e-TGq-Okm6DJEqwZP3gI7Ng50",
        serviceProvider: { 
            signatureMethod: "HMAC-SHA1"
        }        
    };

    // private methods

    var getParamMapForAuth = function(action, method) {
        var message = { 
            action: action,
            method: method,
            parameters: []
        };
        message.parameters.push(['callback', 'cb']);
        message.parameters.push(['oauth_consumer_key', auth.consumerKey]);
        message.parameters.push(['oauth_consumer_secret', auth.consumerSecret]);
        message.parameters.push(['oauth_token', auth.accessToken]);
        message.parameters.push(['oauth_signature_method', auth.serviceProvider.signatureMethod]);

        var accessor = {
            consumerSecret: auth.consumerSecret,
            tokenSecret: auth.accessTokenSecret
        };
        
        OAuth.setTimestampAndNonce(message);
        OAuth.SignatureMethod.sign(message, accessor);
        
        var parameterMap = OAuth.getParameterMap(message.parameters);
        parameterMap.oauth_signature = OAuth.percentEncode(parameterMap.oauth_signature);

        return parameterMap;
    };

    var apiRequest = function(url, successCallback) {
        var method = 'GET';
        var paramMap = getParamMapForAuth(url, method);

        $.ajax({
            type: method,
            url: url,
            data: paramMap,
            cache: true,
            dataType: 'jsonp',
            jsonpCallback: 'cb',
            success: function(data, statusText, XMLHttpRequest) {
                successCallback(data);
            },
            error: function(data, statusText, XMLHttpRequest) {
                onApiError();
            }
        });  
    };

    // public methods

    this.search = function(successCallback, location, term, limit, offset, sort, category_filter, radius_filter) {
        var url = 'http://api.yelp.com/v2/search?location=' + encodeURIComponent(location);

        if (term) {
            url += "&term=" + encodeURIComponent(term);
        }
        if (limit) {
            url += "&limit=" + encodeURIComponent(limit);
        }
        if (offset) {
            url += "&offset=" + encodeURIComponent(offset);
        }
        if (sort) {
            url += "&sort=" + encodeURIComponent(sort);
        }
        if (category_filter) {
            url += "&category_filter=" + encodeURIComponent(category_filter);
        }
        if (radius_filter) {
            url += "&radius_filter=" + encodeURIComponent(radius_filter);
        }

        apiRequest(url, successCallback);
    };

    this.business = function(successCallback, businessId) {
        var url = 'http://api.yelp.com/v2/business/' + businessId;

        apiRequest(url, successCallback);
    };

}

function YelpApiDebug(onApiError) {

    var fullData = {"region": {"span": {"latitude_delta": 0.094671280000000024, "longitude_delta": 0.063118220000006886}, "center": {"latitude": 40.732685799999999, "longitude": -73.981119500000005}}, "total": 321, "businesses": [{"is_claimed": false, "rating": 3.5, "mobile_url": "http://m.yelp.com/biz/ise-japanese-restaurant-new-york-2", "rating_img_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/5ef3eb3cb162/ico/stars/stars_3_half.png", "review_count": 100, "name": "Ise Japanese Restaurant", "snippet_image_url": "http://s3-media2.ak.yelpcdn.com/photo/7-vHoraU_1jsk8eJUteJpA/ms.jpg", "rating_img_url_small": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/2e909d5d3536/ico/stars/stars_small_3_half.png", "url": "http://www.yelp.com/biz/ise-japanese-restaurant-new-york-2", "phone": "2127851600", "snippet_text": "This place has the best sushi in the city, especially for the relatively low prices they charge for the high quality they offer.\n\nYou know it's legit when...", "image_url": "http://s3-media1.ak.yelpcdn.com/bphoto/4MyaSE7UboNcxw_f9kvUGA/ms.jpg", "categories": [["Sushi Bars", "sushi"], ["Japanese", "japanese"]], "display_phone": "+1-212-785-1600", "rating_img_url_large": "http://s3-media1.ak.yelpcdn.com/assets/2/www/img/bd9b7a815d1b/ico/stars/stars_large_3_half.png", "id": "ise-japanese-restaurant-new-york-2", "is_closed": false, "location": {"cross_streets": "Pearl St \u0026 William St", "city": "New York", "display_address": ["56 Pine St", "(b/t Pearl St \u0026 William St)", "Financial District", "New York, NY 10005"], "geo_accuracy": 8, "neighborhoods": ["Financial District"], "postal_code": "10005", "country_code": "US", "address": ["56 Pine St"], "coordinate": {"latitude": 40.706800800000003, "longitude": -74.008452899999995}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/zutto-japanese-american-pub-new-york-2", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 203, "name": "Zutto Japanese American Pub", "snippet_image_url": "http://s3-media2.ak.yelpcdn.com/photo/31CiXbJnxmBW_oSFxNlqHg/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/zutto-japanese-american-pub-new-york-2", "phone": "2122333287", "snippet_text": "I found my place for ramen.\nBefore Zutto I've had a love-hate relationship with ramen. I've tried virtually all of the ramen spots at St. Marks, and as...", "image_url": "http://s3-media4.ak.yelpcdn.com/bphoto/jKr2Sv-rrVlJqmIHv-q5Mw/ms.jpg", "categories": [["Asian Fusion", "asianfusion"], ["Japanese", "japanese"], ["Sushi Bars", "sushi"]], "display_phone": "+1-212-233-3287", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "zutto-japanese-american-pub-new-york-2", "is_closed": false, "location": {"cross_streets": "Worth St \u0026 Harrison St", "city": "New York", "display_address": ["77 Hudson St", "(b/t Worth St \u0026 Harrison St)", "TriBeCa", "New York, NY 10013"], "geo_accuracy": 8, "neighborhoods": ["TriBeCa"], "postal_code": "10013", "country_code": "US", "address": ["77 Hudson St"], "coordinate": {"latitude": 40.718473199999998, "longitude": -74.009077899999994}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.5, "mobile_url": "http://m.yelp.com/biz/sakagura-new-york", "rating_img_url": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/99493c12711e/ico/stars/stars_4_half.png", "review_count": 685, "name": "Sakagura", "snippet_image_url": "http://s3-media4.ak.yelpcdn.com/photo/N4bLdPgFz7G9zmlX03bzPw/ms.jpg", "rating_img_url_small": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/a5221e66bc70/ico/stars/stars_small_4_half.png", "url": "http://www.yelp.com/biz/sakagura-new-york", "phone": "2129537253", "snippet_text": "What an under-ground treasure... my favorite restaurants on the entire planet Earth. Would still be my favorite even if its $10-30 more expensive per...", "image_url": "http://s3-media1.ak.yelpcdn.com/bphoto/VoTfcuZawdR0axLNzQYNEg/ms.jpg", "categories": [["Japanese", "japanese"], ["Arcades", "arcades"]], "display_phone": "+1-212-953-7253", "rating_img_url_large": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/9f83790ff7f6/ico/stars/stars_large_4_half.png", "id": "sakagura-new-york", "is_closed": false, "location": {"cross_streets": "3rd Ave \u0026 2nd Ave", "city": "New York", "display_address": ["211 E 43rd St", "Basement 1", "(b/t 3rd Ave \u0026 2nd Ave)", "Midtown East", "New York, NY 10017"], "geo_accuracy": 8, "neighborhoods": ["Midtown East"], "postal_code": "10017", "country_code": "US", "address": ["211 E 43rd St", "Basement 1"], "coordinate": {"latitude": 40.751195699999997, "longitude": -73.973198600000003}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/hirokos-place-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 129, "name": "Hiroko's Place", "snippet_image_url": "http://s3-media4.ak.yelpcdn.com/photo/0QMVPMYzdfWxe0c056WreA/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/hirokos-place-new-york", "phone": "2126251303", "snippet_text": "this is one of my favourite restaurants in NYC.  the food they have is what i used to have when i was a child.  nothing special, hamburger with rice, omu...", "image_url": "http://s3-media2.ak.yelpcdn.com/bphoto/kSfj8tii1tw8bH1OYmb-wg/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-625-1303", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "hirokos-place-new-york", "is_closed": false, "location": {"cross_streets": "Broome St \u0026 Spring St", "city": "New York", "display_address": ["75 Thompson St", "(b/t Broome St \u0026 Spring St)", "South Village", "New York, NY 10012"], "geo_accuracy": 8, "neighborhoods": ["South Village"], "postal_code": "10012", "country_code": "US", "address": ["75 Thompson St"], "coordinate": {"latitude": 40.724506499999997, "longitude": -74.003110399999997}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.5, "mobile_url": "http://m.yelp.com/biz/kyo-ya-new-york", "rating_img_url": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/99493c12711e/ico/stars/stars_4_half.png", "review_count": 215, "name": "Kyo Ya", "snippet_image_url": "http://s3-media3.ak.yelpcdn.com/photo/gTE2kXNrlbMfNp0gKQkB7w/ms.jpg", "rating_img_url_small": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/a5221e66bc70/ico/stars/stars_small_4_half.png", "url": "http://www.yelp.com/biz/kyo-ya-new-york", "phone": "2129824140", "snippet_text": "A meal at Kyo Ya is surreal.  This is an overdue review from the beginning of this year.  \n\nNine courses plus dessert - and they give you the full menu when...", "image_url": "http://s3-media2.ak.yelpcdn.com/bphoto/AuvMqE6f13y1vUHgA_bp1g/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-982-4140", "rating_img_url_large": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/9f83790ff7f6/ico/stars/stars_large_4_half.png", "id": "kyo-ya-new-york", "is_closed": false, "location": {"cross_streets": "1st Ave \u0026 Avenue A", "city": "New York", "display_address": ["94 E 7th St", "(b/t 1st Ave \u0026 Avenue A)", "East Village", "New York, NY 10009"], "geo_accuracy": 8, "neighborhoods": ["East Village"], "postal_code": "10009", "country_code": "US", "address": ["94 E 7th St"], "coordinate": {"latitude": 40.726596999999998, "longitude": -73.985411999999997}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/en-japanese-brasserie-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 602, "name": "EN Japanese Brasserie", "snippet_image_url": "http://s3-media4.ak.yelpcdn.com/photo/jqeiiR7qPPOFYapWRl9cJA/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/en-japanese-brasserie-new-york", "phone": "2126479196", "snippet_text": "Came here with E and MK - cute place. I really want to come here during the Cherry Blossom season - but the place is still beautiful.\n\nI love love love...", "image_url": "http://s3-media2.ak.yelpcdn.com/bphoto/D292Wefwr7W7bmiB0nj85A/ms.jpg", "categories": [["Japanese", "japanese"], ["Sushi Bars", "sushi"]], "display_phone": "+1-212-647-9196", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "en-japanese-brasserie-new-york", "is_closed": false, "location": {"cross_streets": "Leroy St \u0026 St Lukes Pl", "city": "New York", "display_address": ["435 Hudson St", "(b/t Leroy St \u0026 St Lukes Pl)", "West Village", "New York, NY 10014"], "geo_accuracy": 8, "neighborhoods": ["West Village"], "postal_code": "10014", "country_code": "US", "address": ["435 Hudson St"], "coordinate": {"latitude": 40.730437999999999, "longitude": -74.006975600000004}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/go-go-curry-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 555, "name": "Go! Go! Curry!", "snippet_image_url": "http://s3-media1.ak.yelpcdn.com/photo/T23LEIUeuQwucEPHPacPzg/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/go-go-curry-new-york", "phone": "2127305555", "snippet_text": "GO GO GO GO GO GO GO GO GO GO GO GO CURRRRRYY!!!\nI love this place. I can't believe I have not written a review.\nI like to come here on May 5th (go means 5...", "image_url": "http://s3-media1.ak.yelpcdn.com/bphoto/moy0ufDS9cIronf7oNtZtQ/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-730-5555", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "go-go-curry-new-york", "is_closed": false, "location": {"cross_streets": "7th Ave \u0026 8th Ave", "city": "New York", "display_address": ["273 W 38th St", "(b/t 7th Ave \u0026 8th Ave)", "Midtown West", "New York, NY 10018"], "geo_accuracy": 8, "neighborhoods": ["Midtown West"], "postal_code": "10018", "country_code": "US", "address": ["273 W 38th St"], "coordinate": {"latitude": 40.754694100000002, "longitude": -73.991197400000004}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/morimoto-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 1324, "name": "Morimoto", "snippet_image_url": "http://s3-media4.ak.yelpcdn.com/photo/-N5RbonkJioDhbTQ5jiZwA/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/morimoto-new-york", "phone": "2129898883", "snippet_text": "LOVED our meal here. My husband and I came here to celebrate my mother's birthday dinner with a few of her friends.  Hung out downstairs while the rest of...", "image_url": "http://s3-media4.ak.yelpcdn.com/bphoto/Pd5n3jWDdaUMQFWT-0pNSQ/ms.jpg", "categories": [["Japanese", "japanese"], ["Sushi Bars", "sushi"]], "display_phone": "+1-212-989-8883", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "morimoto-new-york", "is_closed": false, "location": {"cross_streets": "Avenue Of The Americas \u0026 5th Ave", "city": "New York", "display_address": ["88 10th Avenue", "(b/t Avenue Of The Americas \u0026 5th Ave)", "Meatpacking District", "New York, NY 10011"], "geo_accuracy": 8, "neighborhoods": ["Meatpacking District", "Chelsea"], "postal_code": "10011", "country_code": "US", "address": ["88 10th Avenue"], "coordinate": {"latitude": 40.7430381, "longitude": -74.007395500000001}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/donburiya-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 287, "name": "Donburiya", "snippet_image_url": "http://s3-media2.ak.yelpcdn.com/photo/ryb-6crBYzcoZmksQ_jsjA/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/donburiya-new-york", "phone": "2129807909", "snippet_text": "Amazing hidden gem of a spot! So many Japanese places for lunch within a 5-10 block radius, it's kinda hard to sort through them all to figure out which are...", "image_url": "http://s3-media1.ak.yelpcdn.com/bphoto/n7kOW1vBDslV0D4S0ozVUA/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-980-7909", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "donburiya-new-york", "is_closed": false, "location": {"cross_streets": "3rd Ave \u0026 Lexington Ave", "city": "New York", "display_address": ["137 E 47th St", "(b/t 3rd Ave \u0026 Lexington Ave)", "Midtown East", "New York, NY 10017"], "geo_accuracy": 8, "neighborhoods": ["Midtown East"], "postal_code": "10017", "country_code": "US", "address": ["137 E 47th St"], "coordinate": {"latitude": 40.754519000000002, "longitude": -73.972894999999994}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/hibino-brooklyn", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 190, "name": "Hibino", "snippet_image_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/07ecbaa39caf/gfx/blank_user_medium.gif", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/hibino-brooklyn", "phone": "7182608052", "snippet_text": "The best cold tofu I've ever had.  Since 2005 when they opened, it's still the best I've ever had.  \n\nGreat sushi and beef as well but the tofu is just...", "image_url": "http://s3-media2.ak.yelpcdn.com/bphoto/MfrisrO_3EmrSUkZ6CVDJw/ms.jpg", "categories": [["Japanese", "japanese"], ["Sushi Bars", "sushi"]], "display_phone": "+1-718-260-8052", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "hibino-brooklyn", "is_closed": false, "location": {"cross_streets": "Atlantic Ave \u0026 Pacific St", "city": "Brooklyn", "display_address": ["333 Henry St", "(b/t Atlantic Ave \u0026 Pacific St)", "Cobble Hill", "Brooklyn, NY 11201"], "geo_accuracy": 8, "neighborhoods": ["Cobble Hill"], "postal_code": "11201", "country_code": "US", "address": ["333 Henry St"], "coordinate": {"latitude": 40.689653399999997, "longitude": -73.996578}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/ushiwakamaru-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 269, "name": "Ushiwakamaru", "snippet_image_url": "http://s3-media2.ak.yelpcdn.com/photo/bjYS9wDhaf-by5Vh0qGtlg/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/ushiwakamaru-new-york", "phone": "2122284181", "snippet_text": "This was on my \"must go to\" for so long and finally, I decided, lets go. Our decision was a last min type of thing. I really dont know what could I possibly...", "image_url": "http://s3-media3.ak.yelpcdn.com/bphoto/iQ5WcewbqPPuHyB2RdAyMg/ms.jpg", "categories": [["Sushi Bars", "sushi"], ["Japanese", "japanese"]], "display_phone": "+1-212-228-4181", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "ushiwakamaru-new-york", "is_closed": false, "location": {"cross_streets": "Mac Dougal St \u0026 Sullivan St", "city": "New York", "display_address": ["136 W Houston St", "(b/t Mac Dougal St \u0026 Sullivan St)", "Greenwich Village", "New York, NY 10012"], "geo_accuracy": 8, "neighborhoods": ["Greenwich Village"], "postal_code": "10012", "country_code": "US", "address": ["136 W Houston St"], "coordinate": {"latitude": 40.727965699999999, "longitude": -74.001600100000005}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/sake-bar-hagi-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 720, "name": "Sake Bar Hagi", "snippet_image_url": "http://s3-media1.ak.yelpcdn.com/photo/k0VTlwmGZHN1loen-lC7iA/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/sake-bar-hagi-new-york", "phone": "2127648549", "snippet_text": "I prefer this place over any Michelin star restaurant any time, any day.  We came here on a Saturday night (around 7pm).  Had to wait about 30 minutes to...", "image_url": "http://s3-media2.ak.yelpcdn.com/bphoto/85xC-VzKKAuyyBvuQpKJ6Q/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-764-8549", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "sake-bar-hagi-new-york", "is_closed": false, "location": {"cross_streets": "7th Ave \u0026 Avenue Of The Americas", "city": "New York", "display_address": ["152 W 49th St", "(b/t 7th Ave \u0026 Avenue Of The Americas)", "Theater District", "New York, NY 10019"], "geo_accuracy": 8, "neighborhoods": ["Theater District", "Midtown West"], "postal_code": "10019", "country_code": "US", "address": ["152 W 49th St"], "coordinate": {"latitude": 40.760387000000001, "longitude": -73.982883000000001}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/ippudo-ny-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 4104, "name": "Ippudo NY", "snippet_image_url": "http://s3-media2.ak.yelpcdn.com/photo/tT45T2F6Ge7pCI08Xo3KMQ/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/ippudo-ny-new-york", "phone": "2123880088", "snippet_text": "When I have friends visiting NYC, I often bring them to this place only to find that we're turned off and too hungry to wait. On the fourth time coming to...", "image_url": "http://s3-media4.ak.yelpcdn.com/bphoto/CM4SkTXpyOGBiltkWUscyA/ms.jpg", "categories": [["Japanese", "japanese"], ["Korean", "korean"]], "display_phone": "+1-212-388-0088", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "ippudo-ny-new-york", "is_closed": false, "location": {"cross_streets": "9th St \u0026 10th St", "city": "New York", "display_address": ["65 4th Ave", "(b/t 9th St \u0026 10th St)", "East Village", "New York, NY 10003"], "geo_accuracy": 8, "neighborhoods": ["East Village"], "postal_code": "10003", "country_code": "US", "address": ["65 4th Ave"], "coordinate": {"latitude": 40.7309482, "longitude": -73.990286499999996}, "state_code": "NY"}}, {"is_claimed": true, "rating": 3.5, "mobile_url": "http://m.yelp.com/biz/kenka-new-york", "rating_img_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/5ef3eb3cb162/ico/stars/stars_3_half.png", "review_count": 767, "name": "Kenka", "snippet_image_url": "http://s3-media1.ak.yelpcdn.com/photo/f97WQSln0IUL0vVqQN9EhA/ms.jpg", "rating_img_url_small": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/2e909d5d3536/ico/stars/stars_small_3_half.png", "url": "http://www.yelp.com/biz/kenka-new-york", "phone": "2122546363", "snippet_text": "Kenka is a very Japanese-style fast food place with really good food. We discovered this it when I lived in the East Village years ago and my wife and I...", "image_url": "http://s3-media3.ak.yelpcdn.com/bphoto/R9LYS22ocHpm3FmssLCXpA/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-254-6363", "rating_img_url_large": "http://s3-media1.ak.yelpcdn.com/assets/2/www/img/bd9b7a815d1b/ico/stars/stars_large_3_half.png", "id": "kenka-new-york", "is_closed": false, "location": {"city": "New York", "display_address": ["25 Saint Marks Pl", "East Village", "New York, NY 10003"], "geo_accuracy": 8, "neighborhoods": ["East Village"], "postal_code": "10003", "country_code": "US", "address": ["25 Saint Marks Pl"], "coordinate": {"latitude": 40.729052600000003, "longitude": -73.988485600000004}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/donguri-restaurant-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 54, "name": "Donguri Restaurant", "snippet_image_url": "http://s3-media1.ak.yelpcdn.com/photo/muQGfLSsavD7O8qK7_19tQ/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/donguri-restaurant-new-york", "phone": "2127375656", "snippet_text": "Came here looking craving sushi. Its not a sushi place? Temporarily disappointed until the sashimi came wow! Everything I tried was fantastic!\nIt's a small...", "image_url": "http://s3-media3.ak.yelpcdn.com/bphoto/Pp_2ulx_ewKWGtc6RJlsAw/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-737-5656", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "donguri-restaurant-new-york", "is_closed": false, "location": {"cross_streets": "2nd Ave \u0026 1st Ave", "city": "New York", "display_address": ["309 E 83rd St", "(b/t 2nd Ave \u0026 1st Ave)", "Upper East Side", "New York, NY 10028"], "geo_accuracy": 8, "neighborhoods": ["Upper East Side", "Yorkville"], "postal_code": "10028", "country_code": "US", "address": ["309 E 83rd St"], "coordinate": {"latitude": 40.7757182, "longitude": -73.9524294}, "state_code": "NY"}}, {"is_claimed": false, "rating": 4.5, "mobile_url": "http://m.yelp.com/biz/bohemian-restaurant-new-york", "rating_img_url": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/99493c12711e/ico/stars/stars_4_half.png", "review_count": 185, "name": "Bohemian Restaurant", "snippet_image_url": "http://s3-media1.ak.yelpcdn.com/photo/EvhLhbtA_JTHAnUoRFOooQ/ms.jpg", "rating_img_url_small": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/a5221e66bc70/ico/stars/stars_small_4_half.png", "url": "http://www.yelp.com/biz/bohemian-restaurant-new-york", "snippet_text": "I took my brother here for his birthday as I wanted to treat him to a special experience, and everything I've read about Bohemian indicated it would be a...", "image_url": "http://s3-media4.ak.yelpcdn.com/bphoto/XTnk5XVkVIvo7juzodrPXw/ms.jpg", "categories": [["Japanese", "japanese"]], "rating_img_url_large": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/9f83790ff7f6/ico/stars/stars_large_4_half.png", "id": "bohemian-restaurant-new-york", "is_closed": false, "location": {"cross_streets": "Bowery \u0026 Lafayette St", "city": "New York", "display_address": ["57 Great Jones St", "(b/t Bowery \u0026 Lafayette St)", "NoHo", "New York, NY 10012"], "geo_accuracy": 8, "neighborhoods": ["NoHo", "East Village"], "postal_code": "10012", "country_code": "US", "address": ["57 Great Jones St"], "coordinate": {"latitude": 40.726511700000003, "longitude": -73.9923103}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/otafuku-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 700, "name": "Otafuku", "snippet_image_url": "http://s3-media3.ak.yelpcdn.com/photo/uwC326i5Dk9rE4ekDa3EmA/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/otafuku-new-york", "phone": "2123538503", "snippet_text": "I really wanted to try the combo: Okonomiyake + Octopus Takoyaki.  However, since I came in close to their closing time, they only had Octopus Takoyaki...", "image_url": "http://s3-media3.ak.yelpcdn.com/bphoto/qSBD6i9ZTLeh72qyPITgGw/ms.jpg", "categories": [["Japanese", "japanese"]], "display_phone": "+1-212-353-8503", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "otafuku-new-york", "is_closed": false, "location": {"cross_streets": "2nd Ave \u0026 Stuyvesant St", "city": "New York", "display_address": ["236 E 9th St", "(b/t 2nd Ave \u0026 Stuyvesant St)", "East Village", "New York, NY 10003"], "geo_accuracy": 8, "neighborhoods": ["East Village"], "postal_code": "10003", "country_code": "US", "address": ["236 E 9th St"], "coordinate": {"latitude": 40.729279099999999, "longitude": -73.987973699999998}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.5, "mobile_url": "http://m.yelp.com/biz/cha-an-new-york", "rating_img_url": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/99493c12711e/ico/stars/stars_4_half.png", "review_count": 586, "name": "Cha-An", "snippet_image_url": "http://s3-media3.ak.yelpcdn.com/photo/KSN-sv4drSv6s5jwlJ9eyQ/ms.jpg", "rating_img_url_small": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/a5221e66bc70/ico/stars/stars_small_4_half.png", "url": "http://www.yelp.com/biz/cha-an-new-york", "phone": "2122288030", "snippet_text": "Time after time.\n\nI love Cha An", "image_url": "http://s3-media3.ak.yelpcdn.com/bphoto/yEISM6mkWpXR8dbxojUvCw/ms.jpg", "categories": [["Japanese", "japanese"], ["Tea Rooms", "tea"]], "display_phone": "+1-212-228-8030", "rating_img_url_large": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/9f83790ff7f6/ico/stars/stars_large_4_half.png", "id": "cha-an-new-york", "is_closed": false, "location": {"cross_streets": "Stuyvesant St \u0026 3rd Ave", "city": "New York", "display_address": ["230 E 9th St", "2nd Fl", "(b/t Stuyvesant St \u0026 3rd Ave)", "East Village", "New York, NY 10003"], "geo_accuracy": 8, "neighborhoods": ["East Village"], "postal_code": "10003", "country_code": "US", "address": ["230 E 9th St", "2nd Fl"], "coordinate": {"latitude": 40.729467700000001, "longitude": -73.988126199999996}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.0, "mobile_url": "http://m.yelp.com/biz/hatsuhana-sushi-restaurant-new-york", "rating_img_url": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/c2f3dd9799a5/ico/stars/stars_4.png", "review_count": 400, "name": "Hatsuhana Sushi Restaurant", "snippet_image_url": "http://s3-media4.ak.yelpcdn.com/photo/nTt69AvyqYH_oMg1nP8YyQ/ms.jpg", "rating_img_url_small": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/f62a5be2f902/ico/stars/stars_small_4.png", "url": "http://www.yelp.com/biz/hatsuhana-sushi-restaurant-new-york", "phone": "2123553345", "snippet_text": "My favorite sushi place in the nyc!\n\nJust go for Sashimi Deluxe. I tell ya they give the high end quality of fish in this platter - taste different from the...", "image_url": "http://s3-media2.ak.yelpcdn.com/bphoto/yqxu_IyzeCxuKgN9M5ayFw/ms.jpg", "categories": [["Japanese", "japanese"], ["Sushi Bars", "sushi"]], "display_phone": "+1-212-355-3345", "rating_img_url_large": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/ccf2b76faa2c/ico/stars/stars_large_4.png", "id": "hatsuhana-sushi-restaurant-new-york", "is_closed": false, "location": {"cross_streets": "5th Ave \u0026 Madison Ave", "city": "New York", "display_address": ["17 E 48th St", "(b/t 5th Ave \u0026 Madison Ave)", "Midtown East", "New York, NY 10017"], "geo_accuracy": 8, "neighborhoods": ["Midtown East"], "postal_code": "10017", "country_code": "US", "address": ["17 E 48th St"], "coordinate": {"latitude": 40.756870399999997, "longitude": -73.977053699999999}, "state_code": "NY"}}, {"is_claimed": true, "rating": 4.5, "mobile_url": "http://m.yelp.com/biz/sushi-azabu-new-york", "rating_img_url": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/99493c12711e/ico/stars/stars_4_half.png", "review_count": 175, "name": "Sushi Azabu", "snippet_image_url": "http://s3-media2.ak.yelpcdn.com/photo/HtCFCaXQj4pXLeq_dWzwoQ/ms.jpg", "rating_img_url_small": "http://s3-media4.ak.yelpcdn.com/assets/2/www/img/a5221e66bc70/ico/stars/stars_small_4_half.png", "url": "http://www.yelp.com/biz/sushi-azabu-new-york", "phone": "2122740428", "snippet_text": "Say what?! This place is sick! Perfect subdued decor in soothing bamboo tones. That was my first impression.\n\nOnce seated at the sushi bar, the impeccable...", "image_url": "http://s3-media3.ak.yelpcdn.com/bphoto/A27qgig-JUH8zVSgeFaWBQ/ms.jpg", "categories": [["Sushi Bars", "sushi"], ["Japanese", "japanese"]], "display_phone": "+1-212-274-0428", "rating_img_url_large": "http://s3-media2.ak.yelpcdn.com/assets/2/www/img/9f83790ff7f6/ico/stars/stars_large_4_half.png", "id": "sushi-azabu-new-york", "is_closed": false, "location": {"cross_streets": "Laight St \u0026 Vestry St", "city": "New York", "display_address": ["428 Greenwich St", "(b/t Laight St \u0026 Vestry St)", "TriBeCa", "New York, NY 10013"], "geo_accuracy": 8, "neighborhoods": ["TriBeCa"], "postal_code": "10013", "country_code": "US", "address": ["428 Greenwich St"], "coordinate": {"latitude": 40.722396000000003, "longitude": -74.009809599999997}, "state_code": "NY"}}]};

    this.search = function(successCallback, location, term, limit, offset, sort, category_filter, radius_filter) {
        successCallback(_.clone(fullData, true));
    };

    this.business = function(successCallback, businessId) {
        var businessToUse = {"is_claimed": false, "rating": 3.5, "mobile_url": "http://m.yelp.com/biz/ise-japanese-restaurant-new-york-2", "rating_img_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/5ef3eb3cb162/ico/stars/stars_3_half.png", "review_count": 100, "name": "Ise Japanese Restaurant", "snippet_image_url": "http://s3-media2.ak.yelpcdn.com/photo/7-vHoraU_1jsk8eJUteJpA/ms.jpg", "rating_img_url_small": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/2e909d5d3536/ico/stars/stars_small_3_half.png", "url": "http://www.yelp.com/biz/ise-japanese-restaurant-new-york-2", "reviews": [{"rating": 5, "excerpt": "This is the best sushi place in the financial district. They don't beat you over the head with prices and its a comfortable, quiet place to sit and enjoy a...", "time_created": 1353771898, "rating_image_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/f1def11e4e79/ico/stars/stars_5.png", "rating_image_small_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/c7623205d5cd/ico/stars/stars_small_5.png", "user": {"image_url": "http://s3-media2.ak.yelpcdn.com/photo/fdvhA4abtJLbKEkw7rCyIQ/ms.jpg", "id": "TNH2FkzMStsXBUMUjL8GRw", "name": "E B."}, "rating_image_large_url": "http://s3-media1.ak.yelpcdn.com/assets/2/www/img/22affc4e6c38/ico/stars/stars_large_5.png", "id": "BFi0j0w1WPaVGjvyIoYQ3w"}, {"rating": 5, "excerpt": "I just had lunch today at Ise and had their ramen special for $14.  Such a great deal and the ramen was fantastic!  The broth definitely tasted like hours...", "time_created": 1353553761, "rating_image_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/f1def11e4e79/ico/stars/stars_5.png", "rating_image_small_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/c7623205d5cd/ico/stars/stars_small_5.png", "user": {"image_url": "http://s3-media2.ak.yelpcdn.com/photo/X52FJH0HQcLfGTDxLqUnJw/ms.jpg", "id": "Cq6dJj2u8qr74XalDgP93A", "name": "Kei Ling W."}, "rating_image_large_url": "http://s3-media1.ak.yelpcdn.com/assets/2/www/img/22affc4e6c38/ico/stars/stars_large_5.png", "id": "8DTHNNnQEuKJE7DXHE8KwA"}, {"rating": 3, "excerpt": "Good, but a little pricey.\n\nThe service was fast, but more impersonal than friendly. The sushi was good (and not super over-priced for NYC) but it wasn't...", "time_created": 1353352517, "rating_image_url": "http://s3-media1.ak.yelpcdn.com/assets/2/www/img/34bc8086841c/ico/stars/stars_3.png", "rating_image_small_url": "http://s3-media1.ak.yelpcdn.com/assets/2/www/img/902abeed0983/ico/stars/stars_small_3.png", "user": {"image_url": "http://s3-media1.ak.yelpcdn.com/photo/xNwBuggB9ttW-Omov77vMQ/ms.jpg", "id": "ApJ9YgYU-AhS4a-F5oTGHw", "name": "Nicole L."}, "rating_image_large_url": "http://s3-media3.ak.yelpcdn.com/assets/2/www/img/e8b5b79d37ed/ico/stars/stars_large_3.png", "id": "tZ0BBt-GEItX27DHEthc9Q"}], "phone": "2127851600", "snippet_text": "This place has the best sushi in the city, especially for the relatively low prices they charge for the high quality they offer.\n\nYou know it's legit when...", "image_url": "http://s3-media1.ak.yelpcdn.com/bphoto/4MyaSE7UboNcxw_f9kvUGA/ms.jpg", "categories": [["Sushi Bars", "sushi"], ["Japanese", "japanese"]], "display_phone": "+1-212-785-1600", "rating_img_url_large": "http://s3-media1.ak.yelpcdn.com/assets/2/www/img/bd9b7a815d1b/ico/stars/stars_large_3_half.png", "id": "ise-japanese-restaurant-new-york-2", "is_closed": false, "location": {"cross_streets": "Pearl St \u0026 William St", "city": "New York", "display_address": ["56 Pine St", "(b/t Pearl St \u0026 William St)", "Financial District", "New York, NY 10005"], "geo_accuracy": 8, "neighborhoods": ["Financial District"], "postal_code": "10005", "country_code": "US", "address": ["56 Pine St"], "coordinate": {"latitude": 40.706800800000003, "longitude": -74.008452899999995}, "state_code": "NY"}};
        _.each(fullData.businesses, function(business) {
            if (business.id == businessId) {
                for (var attr in business) {
                    businessToUse[attr] = business[attr];
                }
            }
        });
        successCallback(businessToUse);
    };

}
